# ar4_moveit_config

## Description
This package was generated by the [moveit2 setup assistant](https://moveit.picknik.ai/main/doc/examples/setup_assistant/setup_assistant_tutorial.html).
The assistant generates a list of configuration and launch files based on the URDF file that the assistant receives as input.

```
├── ar4_moveit_config                              # ar4 moveit2 package
│   ├── CMakeLists.txt                             # ar4 moveit2 package compilation rules
│   ├── config                                     # ar4 moveit2 package parameter folder
│   │   ├── ar4.ros2_control.xacro                 # ar4 ros control xacro description file
│   │   ├── ar4.srdf                               # ar4 moveit2 semantic information about the robot structure
│   │   ├── ar4.urdf.xacro                         # ar4 xacro description file
│   │   ├── initial_positions.yaml                 # ar4 moveit2 initial position
│   │   ├── joint_limits.yaml                      # ar4 joint limits
│   │   ├── kinematics.yaml                        # ar4 kinematics parameters
│   │   ├── moveit_controllers.yaml                # ar4 moveit2 controller
│   │   ├── moveit.rviz                            # ar4 rviz2 display configuration file
│   │   ├── pilz_cartesian_limits.yaml
│   │   └── ros2_controllers.yaml                  # ar4 moveit controller configuration
│   ├── launch
│   │   ├── demo.launch.py                         # ar4 moveit2 launch file
│   │   ├── move_group.launch.py
│   │   ├── moveit_rviz.launch.py
│   │   ├── rsp.launch.py
│   │   ├── setup_assistant.launch.py
│   │   ├── spawn_controllers.launch.py
│   │   ├── static_virtual_joint_tfs.launch.py
│   │   └── warehouse_db.launch.py
│   └── package.xml
```

## Necessary modification of files generated by the setup assistant
The files generated by the assistant required some modification for our use case.
`demo.launch.py`: This launch file would spawn nodes that were already being spawned by the arm simulation. So it was reduced to spawning the move_group and RViz with its configuration file.
`move_group.launch.py`: Making the node use the simulation time was necessary to get the correct information from the simulator.

### Generated launch files
- [`demo.launch.py`](./launch/demo.launch.py): Launches necessary Moveit nodes to control the simulated arm.
- [`move_group.launch.py`](./launch/move_group.launch.py): Launches a move_group node, which reads joint_states information to plan and send commands to the arm controller.
- [`moveit_rviz.launch.py`](./launch/moveit_rviz.launch.py): Opens RViz with Moveit configuration to act as interface to command the arm.
- [`rsp.launch.py`](./launch/rsp.launch.py): Launches the robot state publisher. _Note: If ar4_gazebo package is used to spawn the ar4 model, the robot state publisher will be already spawned._
- [`setup_assistant.launch.py`](./launch/setup_assistant.launch.py): Used to open the the Moveit2 setup assistant for this package.
- [`spawn_controllers.launch.py`](./launch/spawn_controllers.launch.py): Used to launch the Moveit fake controller (a FollowJointTrajectory controller) configured by the Moveit Setup Assistant. _Note: If ar4_gazebo package is used to spawn the ar4 model, the robot state publisher will be already spawned._
- [`static_virtual_joint_tfs.launch.py`](./launch/static_virtual_joint_tfs.launch.py): Spawns a static_transform_publisher for every virtual joint in the ar4.srdf configuration file. _Note: If ar4_gazebo package is used to spawn the ar4 model, a virtual joint will already be published._
- [`warehouse_db.launch.py`](./launch/warehouse_db.launch.py): Can be used to store persistent planning scenes and robot states. By default warehouse_ros_mongo is set to be used, but that package is not currently available. More info: https://github.com/ros-planning/warehouse_ros_mongo/issues/75#issuecomment-1594971107 todo: Fix this launch file and move_group to use warehouse_ros_sqlite instead. (might need changes here and move_group). More info about db change: https://github.com/ros-planning/warehouse_ros_sqlite


To launch the demo, follow the steps in the [README.md](../README.md) located in the root of the project folder.
